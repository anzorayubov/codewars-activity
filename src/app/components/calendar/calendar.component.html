@if (isLoading) {
  <div class="loader-container">
    <div class="spinner"></div>
    <p>Loading activity data...</p>
  </div>
}

@if (errorMessage) {
  <div class="error-container">
    <div class="error-icon">⚠️</div>
    <p class="error-message">{{errorMessage}}</p>
  </div>
}

@if (!isLoading && !errorMessage) {
  <div class="years" [ngClass]="years.length > 0 ? 'visible' : ''">
    @for (year of years; track year) {
      <div
        class="year"
        >
        <span>{{year.year}} <span>Total completed: {{year.completedKata.length}}</span> </span>
        <div class="month">
          <p>Jan</p>
          <p>Feb</p>
          <p>Mar</p>
          <p>Apr</p>
          <p>May</p>
          <p>Jun</p>
          <p>Jul</p>
          <p>Aug</p>
          <p>Sep</p>
          <p>Oct</p>
          <p>Nov</p>
          <p>Dec</p>
        </div>
        <div class="days">
          @for (week of year.weeks; track week; let isLast = $last) {
            <div [ngClass]="{'week': true, 'last-week': isLast}">
              @for (day of week; track day) {
                <div
              [ngClass]="{
                'day': !day.isPlaceholder,
                'day-placeholder': day.isPlaceholder,
                'hasKata': !day.isPlaceholder && day.completedKata.length > 0,
                'hasKata-2': !day.isPlaceholder && day.completedKata.length > 3,
                'hasKata-3': !day.isPlaceholder && day.completedKata.length > 4,
                'hasKata-4': !day.isPlaceholder && day.completedKata.length > 6
              }">
                  @if (!day.isPlaceholder) {
                    <div class="hover-text">
                      <span class="tooltip-text">
                        <span>{{day.date | date: 'EEE dd MMM '}}</span>
                        @for (kata of day.completedKata; track kata) {
                          <span class="kataName">- {{kata.name}}</span>
                        }
                      </span>
                    </div>
                  }
                </div>
              }
            </div>
          }
        </div>
      </div>
    }
  </div>

  @if (years.length === 0) {
    <div class="empty-state">
      <p>Enter a CodeWars username to see activity</p>
    </div>
  }
}
